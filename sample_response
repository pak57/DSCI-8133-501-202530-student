import subprocess
import time
import platform

# List of switch IP addresses (replace with your actual IPs)
switch_ips = ["192.168.1.1", "192.168.1.2", "192.168.1.3"]

def ping_host(ip):
    """
    Ping the host and return the response time in ms or None if failed.
    """
    param = "-n" if platform.system().lower() == "windows" else "-c"
    command = ["ping", param, "1", "-w", "1", ip]  # -w 1 for timeout 1 second
    
    try:
        output = subprocess.check_output(command, universal_newlines=True)
        # Parse the time from output
        if "time=" in output:
            time_str = output.split("time=")[-1].split("ms")[0].strip()
            return float(time_str)
        elif "time<" in output:  # For very low times like time<1ms
            return 0.0
        else:
            return None
    except subprocess.CalledProcessError:
        return None

while True:
    print("\nPolling switches...")
    for ip in switch_ips:
        response_time = ping_host(ip)
        if response_time is not None:
            print(f"Switch {ip}: Response time = {response_time} ms")
        else:
            print(f"Switch {ip}: No response")
    
    time.sleep(10)  # Update every 10 seconds
